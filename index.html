<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Line Liff App</title>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<button onclick="send()">Test</button>

<body>
    <script>
        var liffId = '1656328926-93YynZeY';
        liff.init({
            liffId: liffId, // Use own liffId
        })
            .then(() => {
                // start to use LIFF's api
                console.log(liff.isLoggedIn());
            })
            .catch((err) => {
                console.log(err);
            });

        function send() {
            if (liff.isLoggedIn() == false) {
                if (!liff.isLoggedIn()) {
                    liff.login({ redirectUri: "https://gray-field-0f0ad0c00.azurestaticapps.net" });
                }
            }
            liff.shareTargetPicker(
                [
                    {
                        type: "flex",
                        altText: "Happy Birthday!!",
                        contents: getFlex(),
                    },
                ],
                {
                    isMultiple: true,
                }
            )
                .then(function (res) {
                    if (res) {
                        // succeeded in sending a message through TargetPicker
                        console.log(`[${res.status}] Message sent!`)
                    } else {
                        const [majorVer, minorVer] = (liff.getLineVersion() || "").split('.');
                        if (parseInt(majorVer) == 10 && parseInt(minorVer) < 11) {
                            // LINE 10.3.0 - 10.10.0
                            // Old LINE will access here regardless of user's action
                            console.log('TargetPicker was opened at least. Whether succeeded to send message is unclear')
                        } else {
                            // LINE 10.11.0 -
                            // sending message canceled
                            console.log('TargetPicker was closed!')
                        }
                    }
                }).catch(function (error) {
                    // something went wrong before sending a message
                    console.log(error);
                    console.log('something wrong happen')
                })
        }

        function getFlex() {
            return {
                "type": "bubble",
                "size": "giga",
                "hero": {
                    "type": "image",
                    "url": "https://i.imgur.com/ZhldXMe.png",
                    "size": "full",
                    "aspectMode": "cover"
                },
                "body": {
                    "type": "box",
                    "layout": "vertical",
                    "spacing": "md",
                    "contents": [
                        {
                            "type": "text",
                            "wrap": true,
                            "weight": "bold",
                            "gravity": "center",
                            "size": "xl",
                            "text": "Allen,"
                        },
                        {
                            "type": "text",
                            "text": "有沒有人毛那麼多阿?\n明明已經人生勝利組了煩惱還一堆(boooo)\n我這一生好像都被射手座圍繞 XD\n感謝偉大的總監日常有你一起幹話.嘴砲\n噁心的話不說太多了\n什麼時候才真正要帶我飛\n生日快樂啦!!",
                            "wrap": true,
                            "margin": "lg"
                        }
                    ]
                },
                "footer": {
                    "type": "box",
                    "layout": "vertical",
                    "contents": [
                        {
                            "type": "button",
                            "style": "primary",
                            "color": "#1c2143",
                            "action": {
                                "type": "uri",
                                "label": "分享序號給老婆",
                                "uri": "https://line.me/R/share?text=psed502f17eyxd"
                            }
                        }
                    ]
                }
            }
        }
    </script>
</body>

</html>